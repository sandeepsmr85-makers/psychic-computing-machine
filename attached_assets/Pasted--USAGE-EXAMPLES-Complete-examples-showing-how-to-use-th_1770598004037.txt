/**

- USAGE EXAMPLES
- Complete examples showing how to use the Universal Web Automation System
  */

import UniversalWebAutomation from â€œ./complete-automation-systemâ€;
import { z } from â€œzodâ€;

// ============================================================================
// EXAMPLE 1: BASIC TEACHING & EXECUTION
// ============================================================================

async function example1_BasicTeaching() {
const automation = new UniversalWebAutomation();
await automation.initialize({ env: â€œLOCALâ€, headless: false });

// Navigate to website
await automation.goto(â€œhttps://github.comâ€);

// Teach individual actions
await automation.teach(â€œsearchâ€, â€œclick the search buttonâ€);
await automation.teach(â€œtype_queryâ€, â€œtype {query} in search boxâ€);
await automation.teach(â€œselect_firstâ€, â€œclick the first repository resultâ€);

// Later: Execute combined workflow
const result = await automation.executeWorkflow([
{ actionName: â€œsearchâ€ },
{ actionName: â€œtype_queryâ€, params: { query: â€œstagehandâ€ } },
{ actionName: â€œselect_firstâ€ },
]);

console.log(result);
await automation.close();
}

// ============================================================================
// EXAMPLE 2: NATURAL LANGUAGE PROMPTS
// ============================================================================

async function example2_NaturalLanguagePrompts() {
const automation = new UniversalWebAutomation();
await automation.initialize({ env: â€œBROWSERBASEâ€ });

await automation.goto(â€œhttps://amazon.comâ€);

// First time - system learns
await automation.prompt(â€œsearch for gaming laptops under $1500 and click the first resultâ€);

// System automatically:
// 1. Parses the instruction
// 2. Breaks it into steps
// 3. Executes each step
// 4. Caches successful actions

// Second time - uses cache (fast & cheap!)
await automation.prompt(â€œsearch for wireless headphones and click the first resultâ€);

await automation.close();
}

// ============================================================================
// EXAMPLE 3: INCREMENTAL LEARNING (Your Use Case!)
// ============================================================================

async function example3_IncrementalLearning() {
const automation = new UniversalWebAutomation();
await automation.initialize();

await automation.goto(â€œhttps://twitter.comâ€);

// SESSION 1: Teach login flow
console.log(â€\n=== SESSION 1: Teaching Login ===â€);
await automation.teach(â€œclick_loginâ€, â€œclick the login buttonâ€);
await automation.teach(â€œenter_usernameâ€, â€œtype {username} in username fieldâ€);
await automation.teach(â€œenter_passwordâ€, â€œtype {password} in password fieldâ€);
await automation.teach(â€œsubmit_loginâ€, â€œclick the login submit buttonâ€);

// SESSION 2: Teach search
console.log(â€\n=== SESSION 2: Teaching Search ===â€);
await automation.teach(â€œclick_searchâ€, â€œclick the search iconâ€);
await automation.teach(â€œtype_searchâ€, â€œtype {query} in search boxâ€);

// SESSION 3: Teach posting
console.log(â€\n=== SESSION 3: Teaching Post ===â€);
await automation.teach(â€œclick_tweetâ€, â€œclick the tweet buttonâ€);
await automation.teach(â€œwrite_tweetâ€, â€œtype {text} in tweet boxâ€);
await automation.teach(â€œsend_tweetâ€, â€œclick send tweetâ€);

// LATER: Combine everything in one prompt!
console.log(â€\n=== COMBINED WORKFLOW ===â€);
const result = await automation.prompt(
â€œlogin with username john@example.com and password secret123, then search for #AI, then post a tweet saying â€˜Interesting discussion!â€™â€
);

console.log(â€œStats:â€, automation.getStats());
// Result will show high cache hit rate = fast & cheap!

await automation.close();
}

// ============================================================================
// EXAMPLE 4: WEB SCRAPING
// ============================================================================

async function example4_WebScraping() {
const automation = new UniversalWebAutomation();
await automation.initialize();

await automation.goto(â€œhttps://news.ycombinator.comâ€);

// Define what data to extract
const articleSchema = z.object({
title: z.string(),
url: z.string(),
points: z.number(),
author: z.string(),
});

// Scrape single article
const article = await automation.scrape(
â€œextract the title, url, points, and author of the first articleâ€,
articleSchema
);

console.log(â€œScraped article:â€, article);

// Scrape multiple articles
const articlesSchema = z.array(
z.object({
title: z.string(),
points: z.number(),
})
);

const articles = await automation.scrape(â€œextract title and points of all articles on this pageâ€, articlesSchema);

console.log(`Scraped ${articles.length} articles`);

await automation.close();
}

// ============================================================================
// EXAMPLE 5: MULTI-PAGE SCRAPING (Pagination)
// ============================================================================

async function example5_MultiPageScraping() {
const automation = new UniversalWebAutomation();
await automation.initialize();

await automation.goto(â€œhttps://news.ycombinator.comâ€);

const articleSchema = z.object({
title: z.string(),
points: z.number(),
});

// Scrape across multiple pages
const allArticles = await automation.scrapeMultiple(
â€œextract all article titles and points from this pageâ€,
z.array(articleSchema),
{
maxPages: 3,
nextPageAction: â€œclick the more button at the bottomâ€,
stopCondition: (data) => data.length >= 100, // Stop after 100 articles
}
);

console.log(`Total articles scraped: ${allArticles.flat().length}`);

await automation.close();
}

// ============================================================================
// EXAMPLE 6: GENERATE RERUNNABLE CODE
// ============================================================================

async function example6_GenerateCode() {
const automation = new UniversalWebAutomation();
await automation.initialize();

await automation.goto(â€œhttps://github.comâ€);

// Execute workflow
await automation.prompt(â€œsearch for â€˜reactâ€™ and click the first repositoryâ€);

// Generate rerunnable code from what just happened
const script = await automation.generateCodeFromLastWorkflow(â€œgithub_search_reactâ€);

console.log(`Generated script: ${script.filename}`);
console.log(â€œCode preview:â€);
console.log(script.code);

// Now you can run the generated .ts file independently!
// $ ts-node generated-scripts/github_search_react.ts

await automation.close();
}

// ============================================================================
// EXAMPLE 7: COMPLEX E-COMMERCE WORKFLOW
// ============================================================================

async function example7_EcommerceWorkflow() {
const automation = new UniversalWebAutomation();
await automation.initialize({ env: â€œBROWSERBASEâ€ });

await automation.goto(â€œhttps://amazon.comâ€);

// Teach the complete checkout flow
await automation.teachBatch([
{ name: â€œsearch_productâ€, instruction: â€œtype {product} in search box and press enterâ€ },
{ name: â€œselect_firstâ€, instruction: â€œclick the first productâ€ },
{ name: â€œadd_to_cartâ€, instruction: â€œclick add to cart buttonâ€ },
{ name: â€œgoto_cartâ€, instruction: â€œclick the cart iconâ€ },
{ name: â€œproceed_checkoutâ€, instruction: â€œclick proceed to checkoutâ€ },
]);

// Execute complete workflow
const result = await automation.executeWorkflow([
{ actionName: â€œsearch_productâ€, params: { product: â€œwireless mouseâ€ } },
{ actionName: â€œselect_firstâ€ },
{ actionName: â€œadd_to_cartâ€ },
{ actionName: â€œgoto_cartâ€ },
{ actionName: â€œproceed_checkoutâ€ },
]);

// Generate reusable code
await automation.generateCode(â€œamazon_add_to_cartâ€, [
{ actionName: â€œsearch_productâ€, params: { product: â€œ{PRODUCT}â€ } },
{ actionName: â€œselect_firstâ€ },
{ actionName: â€œadd_to_cartâ€ },
]);

console.log(â€œWorkflow stats:â€, automation.getStats());

await automation.close();
}

// ============================================================================
// EXAMPLE 8: FORM FILLING
// ============================================================================

async function example8_FormFilling() {
const automation = new UniversalWebAutomation();
await automation.initialize();

await automation.goto(â€œhttps://example.com/contact-formâ€);

// Teach form fields
await automation.teachBatch([
{ name: â€œfill_nameâ€, instruction: â€œtype {name} in the name fieldâ€ },
{ name: â€œfill_emailâ€, instruction: â€œtype {email} in the email fieldâ€ },
{ name: â€œfill_messageâ€, instruction: â€œtype {message} in the message textareaâ€ },
{ name: â€œsubmitâ€, instruction: â€œclick the submit buttonâ€ },
]);

// Execute with different data
await automation.executeWorkflow([
{ actionName: â€œfill_nameâ€, params: { name: â€œJohn Doeâ€ } },
{ actionName: â€œfill_emailâ€, params: { email: â€œjohn@example.comâ€ } },
{ actionName: â€œfill_messageâ€, params: { message: â€œHello, I need help!â€ } },
{ actionName: â€œsubmitâ€ },
]);

await automation.close();
}

// ============================================================================
// EXAMPLE 9: JOB APPLICATION AUTOMATION
// ============================================================================

async function example9_JobApplication() {
const automation = new UniversalWebAutomation();
await automation.initialize({ env: â€œBROWSERBASEâ€ });

// Apply to multiple job boards
const jobBoards = [
â€œhttps://linkedin.com/jobsâ€,
â€œhttps://indeed.comâ€,
â€œhttps://greenhouse.io/jobsâ€,
];

for (const board of jobBoards) {
await automation.goto(board);

```
// Use natural language - system learns each site
await automation.prompt(
  "search for 'software engineer' jobs in 'San Francisco', filter by remote, and apply to the first 3 jobs"
);

// Each site will be learned and cached separately
console.log(`Completed ${board}`);
```

}

// Generate code for each job board
await automation.generateCodeFromLastWorkflow(â€œauto_apply_jobsâ€);

await automation.close();
}

// ============================================================================
// EXAMPLE 10: DATA MONITORING
// ============================================================================

async function example10_DataMonitoring() {
const automation = new UniversalWebAutomation();
await automation.initialize();

await automation.goto(â€œhttps://example-stock-site.comâ€);

// Teach extraction once
await automation.teach(
â€œget_stock_priceâ€,
â€œextract the current stock priceâ€,
â€œextractâ€,
z.object({
symbol: z.string(),
price: z.number(),
change: z.number(),
})
);

// Set up monitoring loop
const priceHistory = [];

for (let i = 0; i < 10; i++) {
const price = await automation.execute(â€œget_stock_priceâ€);
priceHistory.push({ time: new Date(), â€¦price });

```
console.log(`Price check ${i + 1}:`, price);

// Wait 5 minutes
await new Promise((resolve) => setTimeout(resolve, 5 * 60 * 1000));
```

}

console.log(â€œPrice history:â€, priceHistory);

await automation.close();
}

// ============================================================================
// EXAMPLE 11: CACHE MANAGEMENT
// ============================================================================

async function example11_CacheManagement() {
const automation = new UniversalWebAutomation();
await automation.initialize();

await automation.goto(â€œhttps://github.comâ€);

// Teach some actions
await automation.teach(â€œsearchâ€, â€œclick searchâ€);
await automation.teach(â€œloginâ€, â€œclick sign inâ€);

// List all cached actions
const allActions = automation.listCachedActions();
console.log(â€œAll cached actions:â€, allActions);

// List actions for specific site
const githubActions = automation.listCachedActions(â€œgithub.comâ€);
console.log(â€œGitHub actions:â€, githubActions);

// Get statistics
const stats = automation.getStats();
console.log(â€œStats:â€, stats);

// Clear cache for specific site
automation.clearCache(â€œgithub.comâ€);

// Or clear all
// automation.clearCache();

await automation.close();
}

// ============================================================================
// EXAMPLE 12: ERROR HANDLING & FALLBACKS
// ============================================================================

async function example12_ErrorHandling() {
const automation = new UniversalWebAutomation();
await automation.initialize();

await automation.goto(â€œhttps://example.comâ€);

try {
// Try cached action first
await automation.execute(â€œcached_action_that_might_failâ€);
} catch (error) {
console.log(â€œCached action failed, trying freshâ€¦â€);

```
// Clear cache and retry
automation.clearCache("example.com");
await automation.execute("click the button");
```

}

await automation.close();
}

// ============================================================================
// RUN EXAMPLES
// ============================================================================

async function runAllExamples() {
console.log(â€œğŸš€ Running all examplesâ€¦\nâ€);

// Uncomment the example you want to run:

// await example1_BasicTeaching();
// await example2_NaturalLanguagePrompts();
// await example3_IncrementalLearning(); // â† YOUR USE CASE!
// await example4_WebScraping();
// await example5_MultiPageScraping();
// await example6_GenerateCode();
// await example7_EcommerceWorkflow();
// await example8_FormFilling();
// await example9_JobApplication();
// await example10_DataMonitoring();
// await example11_CacheManagement();
// await example12_ErrorHandling();

console.log(â€\nâœ… Examples completed!â€);
}

// Run if executed directly
if (require.main === module) {
runAllExamples().catch(console.error);
}

export {
example1_BasicTeaching,
example2_NaturalLanguagePrompts,
example3_IncrementalLearning,
example4_WebScraping,
example5_MultiPageScraping,
example6_GenerateCode,
example7_EcommerceWorkflow,
example8_FormFilling,
example9_JobApplication,
example10_DataMonitoring,
example11_CacheManagement,
example12_ErrorHandling,
};